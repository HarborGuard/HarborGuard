import { IconExternalLink } from "@tabler/icons-react"
import { CellRendererProps } from "../types"
import { Button } from "@/components/ui/button"

export function cveLinkCell<T>({ value, column }: CellRendererProps<T>) {
  const cveId = value?.toString() || ""
  const baseUrl = column.cellProps?.baseUrl || "https://nvd.nist.gov/vuln/detail/"

  const handleClick = (e: React.MouseEvent) => {
    e.stopPropagation()
    window.open(`${baseUrl}${cveId}`, '_blank')
  }

  return (
    <div className="flex items-center gap-1">
      <span className="font-mono text-sm">{cveId}</span>
      {cveId && (
        <Button
          variant="ghost"
          size="sm"
          className="h-5 w-5 p-0"
          onClick={handleClick}
        >
          <IconExternalLink className="h-3 w-3" />
        </Button>
      )}
    </div>
  )
}